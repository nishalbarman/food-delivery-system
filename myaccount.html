<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomato - My Orders</title>
    <link rel="stylesheet" href="styles/myaccount.css" />
    <!-- <link rel="stylesheet" href="styles/sidenav.css" /> -->
    <link rel="stylesheet" href="styles/header.css" />
    <link rel="stylesheet" href="styles/head.css" />

    <script>
        let loggedin = window.localStorage.getItem("authToken");
        if (!(loggedin !== "" && loggedin === "success")) {
            alert(
                "You are not logged in, kindly log in or sign up to view account section."
            );
            window.location = "./index.html";
        }

        function logOut() {
            window.localStorage.setItem("authToken", '');
            window.localStorage.setItem("userId", '');
        }

        function setButton() {
            let loggedin = window.localStorage.getItem("authToken");
            if (!(loggedin !== "" && loggedin === "success")) {
                document.getElementById('loginBtnHead').textContent = "LogIn";
                document.getElementById('loginBtnHead').href = "./log.html";
                document.getElementById('loginBtnHead').setAttribute('onclick', '');
                // document.querySelectorAll('[hide-me]').forEach(element => {
                //     element.style.display = "none";
                // });
            } else {
                document.querySelectorAll('[hide-me]').forEach(element => {
                    element.style.display = "block";
                });
            }

        }

    </script>
    <!-- <style>
        .hide {
            display: none;
        }
    </style> -->
</head>

<body onload="setButton()">

    <header class="site-header">
        <div class="site-identity">
            <h1><a href="#">Food Clash</a></h1>
        </div>
        <nav class="site-navigation">
            <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="menu.html">Food Menu</a></li>
                <li><a hide-me href="orders.html" style="display: none;">My Orders</a></li>
                <li><a hide-me href="myaccount.html" style="display: none;">My Account</a></li>
                <li><a id="loginBtnHead" href="log.html" onclick="logOut()">LogOut</a></li>
            </ul>
        </nav>
    </header>
    <!-- <div class="bg-image">
        <div id="navbar">

            <div class="header">
                <span class="menu" onclick="openNav()">&#9776;</span>
                <a href="#" class="logo">Tomato</a>
            </div>
            <div id="mySidenav" class="sidenav">
                <img class="logoimg" src="assets/logo_tomato.png" />
                <span id="closebtn" class="closebtn" onclick="closeNav()">&times;</span>
                <a href="index.html">Home</a>
                <a href="orders.html">My Orders</a>
                <a href="myaccount.html">My Account</a>
                <a href="logout.html" onclick="logOut()">LogOut</a>
            </div>

        </div>
        <div class="searchBar">
            <form id="search-form" class="search-form" role="search">
                <input id="searchInput" class="sInput" type="search" placeholder="Search" aria-label="Search">
            </form>
            <button type="button" class="searchBtn"
                onclick="smoothScroll(document.getElementById('order-list'))">Search</button>

        </div>
    </div> -->


    <div id="main" style="margin-top: 20px;">
        <div class="container">
            <div class="side-bar">
                <div class="user-info">
                    <div class="user-img">
                        <img src="user-pic/profile.webp" class="user-img-el" />
                    </div>
                    <div class="user-body">
                        <div class="greeting">
                            <label user-greeting>Hello</label><label>,</label>
                        </div>
                        <div class="user-name">
                            <label user-name>Nishal Barman</label>
                        </div>
                    </div>
                </div>
                <div class="other-details">
                    <div class="profile-title">
                        <a href="#" class="myaccount-a" onclick="toogleMe(this)" account-sidebar>Profile Settings</a>
                    </div>
                    <div class="profile-address">
                        <a href="#" class="myaccount-a" onclick="toogleMe(this)" account-sidebar>Give Feedback</a>
                    </div>
                </div>
            </div>

            <div id="profile-setting" class="info-container">
                <div class="info-container-title">
                    <label info-container-title-el>Profile Settings</label>
                </div>
                <div class="user-data-container">
                    <div class="name">
                        <div class="inputWrapper">
                            <label class="fadeout">&#x2192; First Name <span class="required">*</span> &#x2190;</label>
                            <input name="fname" id="fname" type="text" class="inputs" />
                        </div>
                        <div class="gap"></div>
                        <div class="inputWrapper">
                            <label class="fadeout">&#x2192; Last Name <span class="required">*</span> &#x2190;</label>
                            <input name="sname" id="sname" type="text" class="inputs" />
                        </div>
                    </div>
                    <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Phone Number <span class="required">*</span> &#x2190;</label>
                            <input name="fname" id="fname" type="text" class="inputs" />
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Email Address <span class="required">*</span> &#x2190;</label>
                            <input id="email1" name="email" type="emails" class="inputs" disabled email />
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Gender <span class="required">*</span> &#x2190;</label>
                            <select name="gender" id="gender">
                                <option>--- Select ---</option> <span class="required">*</span>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper" style="height: 100px;">
                            <label class="phone">&#x2192; Address <span class="required">*</span> &#x2190;</label>
                            <textarea name="address" id="address" type="address" class="inputs"
                                placeholder="Address"></textarea>
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Pin Code <span class="required">*</span> &#x2190;</label>
                            <input name="pincode" id="pincode" type="number" class="inputs" />
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper"
                            style="width: 80%; padding: none; text-align: center; background-color: orange; outline: none; border: none; margin: auto;  margin-top: 20px; margin-bottom: 20px;">
                            <button name="pincode" id="submit" class="submit-btn">Update</button>
                        </div>

                    </div>
                </div>
            </div>

            <div id="feedback-form" class="info-container" style="display: none;">
                <div class="info-container-title">
                    <label info-container-title-el>Feedback</label>
                </div>
                <div class="user-data-container">
                    <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Email Address <span class="required">*</span> &#x2190;</label>
                            <input id="email2" name="email" type="emails" class="inputs" disabled email />
                        </div>

                    </div>
                    <!-- <div class="name">
                        <div class="inputWrapper">
                            <label class="phone">&#x2192; Phone Number <span class="required">*</span> &#x2190;</label>
                            <input name="fname" id="fname" type="text" class="inputs" />
                        </div>

                    </div> -->

                    <div class="name">
                        <div class="inputWrapper" style="height: 100px;">
                            <label class="phone">&#x2192; Feedback <span class="required">*</span> &#x2190;</label>
                            <textarea name="feed" id="feed" type="text" class="inputs" placeholder="Feedback" value=""
                                feedback></textarea>
                        </div>

                    </div>

                    <div class="name">
                        <div class="inputWrapper"
                            style="width: 80%; padding: none; text-align: center; background-color: orange; outline: none; border: none; margin: auto;  margin-top: 20px; margin-bottom: 20px;">
                            <button name="pincode" id="submit-feed" class="submit-btn">Submit Feedback</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <script src="js/myaccount.js"></script>
    <script src="js/sidenav.js"></script>
    <script>
        const submitFeed = document.querySelector("#submit-feed");
        submitFeed.addEventListener('click', () => {
            if (document.querySelector("[feedback]").value === '') {
                alert("Feedback is empty.");
            } else {
                let formdata = new FormData();

                formdata.append("email", window.localStorage.getItem("userId"));
                formdata.append("title", "FoodDelivery");
                formdata.append("feedback", document.getElementById('feed'));

                let postData = {
                    body: formdata,
                    header: {
                        // "Content-Type": "multipart/form-data",
                        "Content-Type": "application/x-www-form-urlencoded",
                    },
                    method: "post"
                }

                fetch("./api/post-feedback.php", postData).then(res => res.json()).then(data => {
                    // if (data.success === true) {
                    if (data.success === true) {
                        document.getElementById('feed').value = "";
                    }
                    alert(data.message);
                    // }
                })
            }
        })
    </script>
</body>

</html>